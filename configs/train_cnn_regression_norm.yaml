# configs/train_cnn_regression_norm.yaml
# 多任务回归（54 维），稳态训练配置
model:
  name: cnn_dual_branch
  embedding:
    mode: linear
    dim: 8
    share_between_utr5_utr3: false
  trunk:
    channels: [64, 128, 256]
logging:
  out_dir: outputs/cnn_v1_reg
  checkpoint_dir: outputs/cnn_v1_reg/checkpoints
  save_every_epochs: 0
  csv_log: logs/cnn_v1_reg_training.csv
task: regression

data:
  dataset_dir: data/processed/seq_cnn_v1_reg
  num_workers: 4 #12           # 24核CPU → 12个loader线程
  prefetch_factor: 2 #4
  pin_memory: true
  persistent_workers: false #true

train:
  epochs: 40                # 建议 30–40；保存 best.ckpt 即可
  batch_size: 512           # 32GB 显存的起点；OOM 就改 384/256
  shuffle: true
  amp: true                 # 混合精度
  standardize_y: true       # 训练时标准化，验证时反标准化计算RMSE
  huber_beta: 1.0           # SmoothL1 的 beta（可在 0.5–1.0 间试）
  grad_clip: 1.0            # 防止偶发梯度爆
  seed: 42
  save_dir: outputs/cnn_v1_reg
  log_interval_steps: 200   # 与你日志一致的打印频率
  eval_every: 1             # 每个 epoch 验证与保存 best

optim:
  name: adamw
  lr: 3e-4
  weight_decay: 0.01
  betas: [0.9, 0.98]
